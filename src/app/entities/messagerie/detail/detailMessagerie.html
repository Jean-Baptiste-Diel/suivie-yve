<!-- messagerie.component.html -->
<div class="page-wrapper">
  <div class="messagerie-container">
    <!-- Liste des conversations -->
    <div class="conversations-list">
      <h3>Mes Conversations</h3>
      <div *ngFor="let conv of conversations"
           (click)="selectConversation(conv)"
           class="conversation-item"
           [class.active]="conv.id === selectedConversation?.id">
        <div class="conversation-title">{{ conv.titre || 'Conversation' }}</div>
        <div class="conversation-preview">
          {{ conv.messages?.[conv.messages.length - 1]?.content || 'Aucun message' }}
        </div>
      </div>
    </div>

    <!-- DÃ©tails de la conversation -->
    <div class="conversation-detail" *ngIf="selectedConversation; else emptyState">
      <div class="conversation-header">
        <h3>{{ selectedConversation.titre || 'Conversation' }}</h3>
      </div>

      <div class="messages-container">
        <div *ngFor="let message of selectedConversation.messages"
             class="message-bubble"
             [class.sent]="message.sender?.nom === currentUser">
          <span>{{ message.content }}</span>
          <span class="message-sender">{{ message.sender?.nom || 'Inconnu' }}</span>
        </div>
      </div>

      <!-- Champ d'envoi de message -->
      <div class="message-input">
        <form (ngSubmit)="sendMessage()" style="display: flex; gap: 10px;">
          <input type="text"
                 [(ngModel)]="newMessage"
                 name="message"
                 placeholder="Ã‰crire un message..."
                 required
                 style="flex: 1; padding: 10px; border-radius: 8px; border: 1px solid #ccc;">
          <button type="submit"
                  style="background-color: #007bff; color: white; padding: 10px 20px; border: none; border-radius: 8px;">
            Envoyer
          </button>
        </form>
      </div>
    </div>

    <!-- Ã‰tat vide -->
    <ng-template #emptyState>
      <div class="empty-state">
        SÃ©lectionnez une conversation pour commencer Ã  discuter ðŸ’¬
      </div>
    </ng-template>
  </div>
</div>
